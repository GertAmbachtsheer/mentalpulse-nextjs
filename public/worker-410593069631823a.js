(()=>{"use strict";let i=self;i.addEventListener("notificationclick",n=>{console.log("[SW] Notification clicked:",n.action,n.notification.data),n.notification.close();let o=n.action,t=n.notification.data;if("respond"===o)console.log("[SW] Respond action clicked"),n.waitUntil(i.clients.matchAll({type:"window",includeUncontrolled:!0}).then(n=>{for(let o of n)if(o.url.includes(i.location.origin)&&"focus"in o)return console.log("[SW] Posting message to client:",t),o.postMessage({type:"NOTIFICATION_CLICK",action:"respond",alert:t}),o.focus();if(i.clients.openWindow)return i.clients.openWindow("/")}));else{if("decline"===o)return void console.log("[SW] Decline action clicked");console.log("[SW] Default notification click (no action)"),n.waitUntil(i.clients.matchAll({type:"window",includeUncontrolled:!0}).then(n=>{for(let o of n)if(o.url.includes(i.location.origin)&&"focus"in o)return o.focus();if(i.clients.openWindow)return i.clients.openWindow("/")}))}}),i.addEventListener("push",n=>{let o=n.data?.json()??{},t=o.title||"MentalPulse Alert",e={body:o.body||"You have a new notification",icon:o.icon||"/icon512_rounded.png",badge:"/icon512_rounded.png",data:o.data||{},requireInteraction:o.requireInteraction??!0,actions:[{action:"view",title:"View Details"},{action:"close",title:"Dismiss"}]};n.waitUntil(i.registration.showNotification(t,e))})})();